<!DOCTYPE html>
<html>
  <head>
    <title>AUHSD Nutrition Portal</title>
    <style>
      body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; display: flex; justify-content: center; padding-top: 50px; background: #f4f4f4; }
      .login-card { background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); width: 350px; }
      h2 { color: #004a99; margin-top: 0; }
      select, input, button { width: 100%; margin: 10px 0; padding: 12px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; font-size: 14px; }
      button { background: #004a99; color: white; border: none; cursor: pointer; font-weight: bold; transition: background 0.3s; }
      button:hover { background: #003366; }
      #error-message { color: #d9534f; font-size: 13px; text-align: center; margin-top: 5px; }
    </style>
  </head>
  <body>
    <div class="login-card">
      <h2>AUHSD Login</h2>
      <p style="font-size: 14px; color: #666;">Production Records Portal</p>
      
      <label style="font-size: 12px; font-weight: bold;">SITE LOCATION</label>
      <select id="school-list">
        <option>Loading sites...</option>
      </select>

      <label style="font-size: 12px; font-weight: bold;">PASSWORD</label>
      <input type="password" id="password" placeholder="••••••••">
      
      <button onclick="handleLogin()">SIGN IN</button>
      <div id="error-message"></div>
    </div>

    <script>
      const select = document.getElementById('school-list');
      const passwordInput = document.getElementById('password');
      const errorDiv = document.getElementById('error-message');

      // PATH ADJUSTMENT: Go up one level (..) then into src/data
      fetch('./src/data/schools.json')
        .then(response => {
          if (!response.ok) throw new Error("Could not find schools.json");
          return response.json();
        })
        .then(data => {
          // Sort Alphabetically
          data.sort((a, b) => a.name.localeCompare(b.name));

          select.innerHTML = '<option value="" disabled selected>-- Select Your School --</option>';
          data.forEach(school => {
            const option = document.createElement('option');
            option.value = school.category; 
            option.textContent = school.name;
            select.appendChild(option);
          });
        })
        .catch(err => {
          console.error(err);
          select.innerHTML = '<option>Error: Check folder structure</option>';
          errorDiv.textContent = "Data load error. Check console (F12).";
        });

      function handleLogin() {
        const selectedSchool = select.options[select.selectedIndex].text;
        const type = select.value;
        const pass = passwordInput.value;

        if (pass === "auhsd2026") {
          alert(`Logged in! \nSchool: ${selectedSchool} \nForm Type: ${type}`);
          // Next step: redirect to the production record entry page
        } else {
          errorDiv.textContent = "Invalid Password.";
        }
      }
    </script>
  </body>
</html>